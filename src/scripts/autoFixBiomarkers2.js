/**
 * autoFixBiomarkers2.js
 * Segunda parte: Correcci√≥n de los biomarcadores restantes con texto mixto
 */

const fs = require('fs');
const path = require('path');

console.log('üîß PARTE 2: CORRECCI√ìN DE BIOMARCADORES RESTANTES\n');

// Traducciones m√©dicas profesionales para los biomarcadores restantes
const biomarkerTranslations2 = {
  B0070: {
    en: "Hepatic enzyme sensitive to alcohol and medications. Marker of cholestasis and chronic liver damage.",
    fr: "Enzyme h√©patique sensible √† l'alcool et m√©dicaments. Marqueur de cholestase et dommage h√©patique chronique."
  },
  B0010: {
    en: "Sum of all cholesterol fractions. Basic marker of cardiovascular risk.",
    fr: "Somme de toutes les fractions de cholest√©rol. Marqueur de base du risque cardiovasculaire."
  },
  B0040: {
    en: "Blood fats. Elevated indicates cardiovascular risk and insulin resistance.",
    fr: "Graisses sanguines. √âlev√©es indiquent risque cardiovasculaire et r√©sistance √† l'insuline."
  },
  B0180: {
    en: "Bad cholesterol. Transports cholesterol to tissues. Elevated increases cardiovascular risk.",
    fr: "Mauvais cholest√©rol. Transporte cholest√©rol vers tissus. √âlev√© augmente risque cardiovasculaire."
  },
  B3110: {
    en: "Protein of atherogenic particles (LDL, VLDL). Better predictor of cardiovascular risk than LDL-cholesterol.",
    fr: "Prot√©ine des particules ath√©rog√®nes (LDL, VLDL). Meilleur pr√©dicteur du risque cardiovasculaire que LDL-cholest√©rol."
  },
  B6160: {
    en: "Main male sex hormone, important in women. Regulates muscle mass, libido and energy.",
    fr: "Principale hormone sexuelle masculine, importante chez les femmes. R√©gule masse musculaire, libido et √©nergie."
  },
  B2800: {
    en: "Thyroid stimulating hormone. Controls thyroid function and metabolism regulation.",
    fr: "Hormone stimulant la thyro√Øde. Contr√¥le fonction thyro√Ødienne et r√©gulation m√©tabolique."
  },
  B2810: {
    en: "Active thyroid hormone. Regulates metabolism, heart rate and body temperature.",
    fr: "Hormone thyro√Ødienne active. R√©gule m√©tabolisme, rythme cardiaque et temp√©rature corporelle."
  },
  B2820: {
    en: "Total thyroid hormone. Indicates thyroid function and metabolic activity.",
    fr: "Hormone thyro√Ødienne totale. Indique fonction thyro√Ødienne et activit√© m√©tabolique."
  },
  B0160: {
    en: "Good cholesterol. Transports cholesterol from tissues to liver. High levels are protective.",
    fr: "Bon cholest√©rol. Transporte cholest√©rol des tissus vers foie. Niveaux √©lev√©s sont protecteurs."
  },
  B0220: {
    en: "Iron transport protein. Reflects iron stores and liver synthesis capacity.",
    fr: "Prot√©ine de transport du fer. Refl√®te r√©serves de fer et capacit√© de synth√®se h√©patique."
  },
  B6140: {
    en: "Male sex hormone bound to proteins. More stable indicator than total testosterone.",
    fr: "Hormone sexuelle masculine li√©e aux prot√©ines. Indicateur plus stable que testost√©rone totale."
  },
  B6150: {
    en: "Unbound active testosterone. Biological activity and androgenic effects.",
    fr: "Testost√©rone libre non li√©e. Activit√© biologique et effets androg√©niques."
  },
  B5350: {
    en: "Main female sex hormone. Regulates menstrual cycle, bone health and cardiovascular protection.",
    fr: "Principale hormone sexuelle f√©minine. R√©gule cycle menstruel, sant√© osseuse et protection cardiovasculaire."
  },
  B5380: {
    en: "Luteinizing hormone. Controls ovarian and testicular function.",
    fr: "Hormone lut√©inisante. Contr√¥le fonction ovarienne et testiculaire."
  },
  B5390: {
    en: "Follicle stimulating hormone. Regulates gamete production and sexual development.",
    fr: "Hormone folliculo-stimulante. R√©gule production de gam√®tes et d√©veloppement sexuel."
  },
  B6050: {
    en: "Stress hormone. Indicates adrenal function and stress response.",
    fr: "Hormone du stress. Indique fonction surr√©nale et r√©ponse au stress."
  },
  B5400: {
    en: "Prolactin hormone. Regulates lactation and reproductive function.",
    fr: "Hormone prolactine. R√©gule lactation et fonction reproductive."
  },
  B5410: {
    en: "Growth hormone. Essential for growth, muscle mass and metabolism.",
    fr: "Hormone de croissance. Essentielle pour croissance, masse musculaire et m√©tabolisme."
  },
  B1430: {
    en: "Essential mineral. Important for oxygen transport and energy metabolism.",
    fr: "Min√©ral essentiel. Important pour transport d'oxyg√®ne et m√©tabolisme √©nerg√©tique."
  },
  B1450: {
    en: "Essential mineral. Important for bone health, muscle function and nerve transmission.",
    fr: "Min√©ral essentiel. Important pour sant√© osseuse, fonction musculaire et transmission nerveuse."
  },
  B1470: {
    en: "Essential mineral. Important for bone and teeth formation, energy metabolism.",
    fr: "Min√©ral essentiel. Important pour formation osseuse et dentaire, m√©tabolisme √©nerg√©tique."
  },
  B1490: {
    en: "Essential mineral. Important for cardiovascular health and bone formation.",
    fr: "Min√©ral essentiel. Important pour sant√© cardiovasculaire et formation osseuse."
  },
  B1510: {
    en: "Essential trace mineral. Important for immune function and wound healing.",
    fr: "Oligo-√©l√©ment essentiel. Important pour fonction immunitaire et cicatrisation."
  },
  B1530: {
    en: "Essential trace mineral. Important for iron metabolism and connective tissue formation.",
    fr: "Oligo-√©l√©ment essentiel. Important pour m√©tabolisme du fer et formation du tissu conjonctif."
  },
  B1550: {
    en: "Essential trace mineral. Important for thyroid function and antioxidant protection.",
    fr: "Oligo-√©l√©ment essentiel. Important pour fonction thyro√Ødienne et protection antioxydante."
  },
  B1570: {
    en: "Essential trace mineral. Important for glucose metabolism and cholesterol regulation.",
    fr: "Oligo-√©l√©ment essentiel. Important pour m√©tabolisme du glucose et r√©gulation du cholest√©rol."
  },
  B1590: {
    en: "Essential trace mineral. Important for enzyme function and uric acid metabolism.",
    fr: "Oligo-√©l√©ment essentiel. Important pour fonction enzymatique et m√©tabolisme de l'acide urique."
  },
  B1610: {
    en: "Potentially toxic heavy metal. Exposure assessment and neurological risk evaluation.",
    fr: "M√©tal lourd potentiellement toxique. √âvaluation d'exposition et risque neurologique."
  },
  B1630: {
    en: "Toxic heavy metal. Exposure assessment and cardiovascular risk evaluation.",
    fr: "M√©tal lourd toxique. √âvaluation d'exposition et risque cardiovasculaire."
  },
  B1650: {
    en: "Toxic heavy metal. Exposure assessment and nephrotoxicity risk evaluation.",
    fr: "M√©tal lourd toxique. √âvaluation d'exposition et risque de n√©phrotoxicit√©."
  },
  B1670: {
    en: "Potentially toxic heavy metal. Exposure assessment and neurological risk evaluation.",
    fr: "M√©tal lourd potentiellement toxique. √âvaluation d'exposition et risque neurologique."
  },
  B1690: {
    en: "Toxic heavy metal. Exposure assessment and multiple organ toxicity evaluation.",
    fr: "M√©tal lourd toxique. √âvaluation d'exposition et toxicit√© multi-organes."
  },
  B6000: {
    en: "Adrenal steroid hormone. Indicates stress response and adrenal function.",
    fr: "Hormone st√©ro√Øde surr√©nale. Indique r√©ponse au stress et fonction surr√©nale."
  },
  B5550: {
    en: "Insulin-like growth factor. Reflects growth hormone activity and longevity marker.",
    fr: "Facteur de croissance similaire √† l'insuline. Refl√®te activit√© hormone de croissance et marqueur de long√©vit√©."
  },
  B8000: {
    en: "Inflammatory marker. Indicates systemic inflammation and cardiovascular risk.",
    fr: "Marqueur inflammatoire. Indique inflammation syst√©mique et risque cardiovasculaire."
  },
  B8020: {
    en: "General inflammatory marker. Indicates acute inflammation and tissue damage.",
    fr: "Marqueur inflammatoire g√©n√©ral. Indique inflammation aigu√´ et dommage tissulaire."
  },
  B8040: {
    en: "Inflammatory cytokine. Indicates chronic inflammation and metabolic dysfunction.",
    fr: "Cytokine inflammatoire. Indique inflammation chronique et dysfonction m√©tabolique."
  },
  B8060: {
    en: "Anti-inflammatory marker. Indicates inflammatory resolution capacity.",
    fr: "Marqueur anti-inflammatoire. Indique capacit√© de r√©solution inflammatoire."
  },
  B8080: {
    en: "Inflammatory marker. Indicates vascular inflammation and atherosclerosis risk.",
    fr: "Marqueur inflammatoire. Indique inflammation vasculaire et risque d'ath√©roscl√©rose."
  }
};

// Funci√≥n para aplicar las correcciones
function applyCorrections2() {
  const contextPath = path.join(__dirname, '../contexts/LanguageContext.js');
  let content = fs.readFileSync(contextPath, 'utf8');
  
  let correctionCount = 0;
  
  Object.entries(biomarkerTranslations2).forEach(([code, translations]) => {
    // Patr√≥n m√°s espec√≠fico para capturar la descripci√≥n completa
    const englishPattern = new RegExp(`("${code}":\\s*{\\s*description:\\s*")[^"]*("\\s*})`, 'g');
    const englishReplacement = `$1${translations.en}$2`;
    
    if (content.match(englishPattern)) {
      content = content.replace(englishPattern, englishReplacement);
      correctionCount++;
    }
    
    // Corregir franc√©s con patr√≥n similar
    const frenchSectionRegex = /(fr:\s*{[\s\S]*?biomarkers:\s*{)([\s\S]*?)(}\s*}[\s\S]*?})/;
    const frenchMatch = content.match(frenchSectionRegex);
    
    if (frenchMatch) {
      let frenchBiomarkers = frenchMatch[2];
      const frenchPattern = new RegExp(`("${code}":\\s*{\\s*description:\\s*")[^"]*("\\s*})`, 'g');
      const frenchReplacement = `$1${translations.fr}$2`;
      
      if (frenchBiomarkers.match(frenchPattern)) {
        frenchBiomarkers = frenchBiomarkers.replace(frenchPattern, frenchReplacement);
        content = content.replace(frenchMatch[0], frenchMatch[1] + frenchBiomarkers + frenchMatch[3]);
        correctionCount++;
      }
    }
  });
  
  // Guardar archivo corregido
  fs.writeFileSync(contextPath, content, 'utf8');
  
  return correctionCount;
}

// Ejecutar correcciones
console.log('üîÑ Aplicando correcciones autom√°ticas parte 2...\n');
const corrections = applyCorrections2();

console.log('‚úÖ CORRECCIONES PARTE 2 COMPLETADAS');
console.log('===================================');
console.log(`Total de correcciones aplicadas: ${corrections}`);
console.log(`Biomarcadores corregidos: ${Object.keys(biomarkerTranslations2).length}`);
console.log('');
console.log('üìã BIOMARCADORES CORREGIDOS EN PARTE 2:');
console.log('--------------------------------------');
Object.keys(biomarkerTranslations2).forEach((code, index) => {
  console.log(`‚úÖ ${index + 1}. ${code}`);
});

console.log('\nüîÑ VERIFICANDO PROGRESO...');
console.log('Ejecuta: node src/scripts/fixAllBiomarkerTranslations.js');
console.log('Para ver cu√°ntos biomarcadores quedan pendientes.');

console.log('\nüéâ ¬°CORRECCI√ìN AUTOM√ÅTICA PARTE 2 COMPLETADA!'); 